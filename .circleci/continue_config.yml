
version: 2.1

orbs:
  node: circleci/node@5.0.2
  slack: circleci/slack@4.12.5

parameters:
  run-salesforce-deploys:
    type: boolean
    default: false

# --- your existing commands and jobs go here unchanged ---

workflows:
  build-test-deploy:
    when: << pipeline.parameters.run-salesforce-deploys >>
    jobs:
      - deploy-intqa:
          context: sf-intqa
          tag_prefix: "INTQA-"
          filters:
            branches:
              only: BRInt

      - deploy-staging:
          context: sf-staging
          tag_prefix: "STAGINGUAT-"
          filters:
            branches:
              only: BRStaging

      - deploy-main:
          context: sf-prod
          tag_prefix: "PROD-"
          filters:
            branches:
              only: main
